---
title: "Untitled"
output: html_document
date: "2024-08-08"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

packages for data cleaning and visualisation 

``` {r libraries}
library(tidyverse)
library(ggplot2)
library(dplyr)

```

read data file into easier name for reference and load data 
```{r }
data <- read.csv("titanic_vis_clean.csv")
```

get a global understanding of data structure and summary statistics 
```{r }
head(data)
summary(data)
str(data)
```

Count of Survived passengers 
```{r }
# barplot
ggplot(data, aes(x = as.factor(survived)))+
         geom_bar()+
         xlab("survived")+
         ylab("count")+
         ggtitle("count of survived passengers")

```
Scatter plot of age distribution and fare price. Most fares are clustered upto 100 fare price, with few outliers above 200 and 500 for those aged between 20-40 years old.
```{r Scatter plot}
# scatter plot      
ggplot(data, aes(x = age, y = fare)) +
  geom_point()
```
Histogram diplaying Age distribution and count. most passengers were ~25-40 years old
```{r}

#histogram
ggplot(data, aes(x = age))+
  geom_histogram(binwidth = 5, fill="blue", color="black")+
  xlab("age")+
  ylab("count")+
  ggtitle("age distribution of passengers")

```
Boxlpot showing age distribution and survival status. Median age is higher for those who did not survive (left box), indicating those younger had a higher survival rate. 
``` {r}
#boxplot
ggplot(data, aes(x = as.factor(survived), y = age))+
  geom_boxplot()+
  xlab("survived")+
  ylab("age")+
  ggtitle("age distribution and density by survival status")

```
Violin plot displaying age distribution and survival status. majority were ~25-30 including those that survived and not survived
``` {r}
#violinplot
ggplot(data, aes(x = as.factor(survived), y = age))+
  geom_violin()+
  xlab("survived")+
  ylab("age")+
  ggtitle("age distribution and density by survival status")
```
bar plot of passenger class type and count
``` {r}
#bar plot of passenger class
ggplot(data, aes(x = as.factor(data$pclass)))+
  geom_bar(fill = "green")+
  xlab("passenger class")+
  ylab("count")+
  ggtitle("count of passenger class")



```
bar plot of Embarkation location and count. Cherbourge (c), Queeenstown (Q), Southampton (S)
``` {r}
#bar plot of Embarked
ggplot(data, aes(x = embarked))+
  geom_bar(fill = "lightblue")+
  xlab("embarking point")+
  ylab("count")+
  ggtitle("count of passenger class")


```

Scatter plot shoing those who paid the highest fares had a higher chance of survival. 
``` {r}
#scatterplot of age vs fare and survival
ggplot(data, aes(x = age, y = fare))+
  geom_point()+
  facet_grid(. ~ survived)+
  xlab("age")+
  ylab("fare")+
  ggtitle("age vs fare by survival staus")
```


Scatter plot showing most passengers had a class 1 ticket
``` {r}
#scatterplot of age vs fare and Pclass

#scatterplot of age vs fare and Pclass
ggplot(data, aes(x = age, y = fare))+
  geom_point(color = "red")+
  facet_grid(. ~ pclass)+
  xlab("age")+
  ylab("fare")+
  ggtitle("age vs fare by passenger class")


```


``` {r}
  # Combined scatter plot of Age vs Fare by Pclass
  ggplot(data, aes(x = age, y = fare, color = as.factor(pclass))) +
  geom_point(size = 2) +
  scale_color_manual(values = c("1" = "red", "2" = "orange", "3" = "green")) +
  xlab("Age") +
  ylab("Fare") +
  ggtitle("Age vs. Fare by Passenger Class") +
  labs(color = "Passenger Class")

```

installation of 'plotly' package for interactive stacked bar plots
``` {r}

install.packages("plotly")
library(plotly)

if (!requireNamespace("dplyr", quietly = TRUE)) {
  install.packages("dplyr")
}
if (!requireNamespace("plotly", quietly = TRUE)) {
  install.packages("plotly")
}
library(dplyr)
library(plotly)


```

data preperation for interactive bar plot by creating new features
``` {r}
data <- data %>%
  group_by(pclass, survived) %>%
  summarise(count = n(), .groups = 'drop') %>%
  mutate(percentage = count / sum(count) * 100)

# Convert to data frame
data <- as.data.frame(data)

# Convert survived to factor
data$survived <- as.factor(data$survived)



```



``` {r}
# interactive stacked bar plot

plot <- plot_ly(data, 
                x = ~pclass, 
                y = ~percentage, 
                type = 'bar', 
                color = ~survived,
                text = ~paste('Survived:', survived, '<br>Percentage:', round(percentage, 2), '%'),
                hoverinfo = 'text',
                textposition = 'auto') %>%
  layout(barmode = 'stack',
         xaxis = list(title = 'Passenger Class'),
         yaxis = list(title = 'Percentage'),
         title = 'Survival Proportions by Passenger Class',
         legend = list(title = list(text = 'Survived')))

plot

```


scatter plot of age vs fare colored by embarkation with linear regression (lm).
``` {r}
# scatter plot of age vs fare colored by embarkation 

data <- read.csv("titanic_vis_clean.csv")

# scatter plot of age vs fare colored by embarkation with linear regression (lm)
ggplot(data, aes (x = age, y = fare, color= embarked))+
  geom_point()+
  geom_smooth(method = "lm", col = "blue")+
  xlab("age")+
  ylab("fare")+
  ggtitle("age and fare by embarkation")


```














